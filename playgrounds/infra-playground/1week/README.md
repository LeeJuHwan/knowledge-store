# subwaymap-1week

<details>

<summary>Properties</summary>

:pencil:2024.09.21

:page\_facing\_up: [ê·¸ëŸ´ë“¯í•œ ì„œë¹„ìŠ¤ ë§Œë“¤ê¸°](https://www.inflearn.com/course/%EC%9D%B8%ED%94%84%EB%9D%BC-%EA%B3%B5%EB%B0%A9-%EC%84%9C%EB%B9%84%EC%8A%A4-%EB%A7%8C%EB%93%A4%EA%B8%B0)

:paperclip: ì§€í•˜ì²  ë…¸ì„ ë„ ë¯¸ì…˜ ì§„í–‰ 1ì£¼ì°¨

**1ì£¼ì°¨ ì»¤ë¦¬í˜ëŸ¼**

</details>

## ê·¸ëŸ´ë“¯í•œ ì¸í”„ë¼ ë§Œë“¤ê¸°

{% hint style="info" %}
ê·¸ëŸ´ë“¯í•œ ì„œë¹„ìŠ¤ ë§Œë“¤ê¸° ì¸í”„ëŸ° ê³¼ì •ì˜ ë¯¸ì…˜ì„ NEXTSTEP ì¸í”„ë¼ ê³µë°©ì²˜ëŸ¼ ì»¤ë¦¬í˜ëŸ¼ì„ ë§Œë“¤ì–´ ì§„í–‰ í•œ ê³¼ì •ì…ë‹ˆë‹¤.
{% endhint %}

### ë§ êµ¬ì„±í•˜ê¸°



#### VPC

{% hint style="info" %}
**ìš”êµ¬ì‚¬í•­**

* CIDRì€ C class(x.x.x.x/24)ë¡œ ìƒì„± (í˜„ì—…ì—ì„  ê°€ê¸‰ì  B classë¡œ ìƒì„±í•´ì£¼ì„¸ìš”)
{% endhint %}

Default VPCëŠ” B Classë¡œ ì´ë£¨ì–´ì ¸ ë²”ìš©ì ìœ¼ë¡œ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤. í•˜ì§€ë§Œ, ìš”êµ¬ì‚¬í•­ì— ë”°ë¥´ë©´ C Classë¡œ Total IP Amount ê°¯ ìˆ˜ê°€ ì ê²Œ ì„¤ì • í•˜ê¸¸ ì›í•œê¸° ë•Œë¬¸ì— C Classë¡œ ì„¤ì •í•œ VPCë¥¼ êµ¬ì„± í•´ì•¼í•œë‹¤.

**C Classì™€ B Class IP í• ë‹¹ ë‚´ìš©**

|   í´ë˜ìŠ¤   |        IP í• ë‹¹ ë²”ìœ„        | ì‚¬ìš© ê°€ëŠ¥í•œ IP ê°œ ìˆ˜ |      ì˜ˆì‹œ      |
| :-----: | :--------------------: | :-----------: | :----------: |
| B Class | 128.0.0.0 \~ 191.0.0.0 | 2^16 (65,536) | 128.12.12.12 |
| C Class | 192.0.0.0 \~ 223.0.0.0 |   2^8 (256)   | 192.168.10.1 |

![image](../../../.gitbook/assets/create_vpc.png)

* [x] CIDRì€ C class(x.x.x.x/24)ë¡œ ìƒì„±

#### Subnets

{% hint style="info" %}
**ìš”êµ¬ì‚¬í•­**

* ì™¸ë¶€ë§ìœ¼ë¡œ ì‚¬ìš©í•  Subnet : 64ê°œì”© 2ê°œ (AZë¥¼ ë‹¤ë¥´ê²Œ êµ¬ì„±)
  * ì™¸ë¶€ë§ì€ ì¸í„°ë„· êµ¬ê°„ê³¼ í†µì‹  ê°€ëŠ¥
* ë‚´ë¶€ë§ìœ¼ë¡œ ì‚¬ìš©í•  Subnet : 32ê°œì”© 1ê°œ
  * ë‚´ë¶€ë§ì—ì„œë§Œ ì¸í„°ë„· ì ‘ê·¼ ê°€ëŠ¥
* ê´€ë¦¬ìš©ìœ¼ë¡œ ì‚¬ìš©í•  Subnet : 32ê°œì”© 1ê°œ (system managerë¥¼ ì‚¬ìš©í•œë‹¤ë©´ ë³„ë„ì˜ ê´€ë¦¬ë§ ì—†ì´ ë‚´ë¶€ë§ 2ê°œë¡œ êµ¬ì„±, ë³´ì•ˆê·¸ë£¹ë„ ìƒí™©ì— ë§ê²Œ êµ¬ì„±)
{% endhint %}

|  ìš©ë„ | ì´ë¦„                    |        CIDR       |        AZ       |
| :-: | --------------------- | :---------------: | :-------------: |
|  ì™¸ë¶€ | subway-map-public-a   |  192.168.10.0/26  | ap-northeast-2a |
|  ì™¸ë¶€ | subway-map-public-c   |  192.168.10.64/26 | ap-northeast-2c |
|  ë‚´ë¶€ | subway-map-internal-a | 192.168.10.128/27 | ap-northeast-2a |
|  ë‚´ë¶€ | subway-map-internal-c | 192.168.10.160/27 | ap-northeast-2c |

* [x] ì™¸ë¶€ë§ ì„œë¸Œë„·1 - 64ê°œ
* [x] ì™¸ë¶€ë§ ì„œë¸Œë„·2 - 64ê°œ
* [x] ë‚´ë¶€ë§ ì„œë¸Œë„·1 - 32ê°œ
* [x] ë‚´ë¶€ë§ ì„œë¸Œë„·2 - 32ê°œ

![image](../../../.gitbook/assets/subway-map-subnets.png)

#### Internet Gateway

{% hint style="info" %}
**ìš”êµ¬ì‚¬í•­**

* [x] ì™¸ë¶€ë§ì€ ì¸í„°ë„· êµ¬ê°„ê³¼ í†µì‹  ê°€ëŠ¥

**ì¸í„°ë„· ê²Œì´íŠ¸ì›¨ì´ëŠ” í¼ë¸”ë¦­ IP ì£¼ì†Œë¥¼ ì§€ë‹Œ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì¸í„°ë„·ê³¼ ì—°ê²°í•˜ë©´ ì¸í„°ë„·ì—ì„œ ë“¤ì–´ì˜¤ëŠ” ìš”ì²­ì„ ìˆ˜ì‹ í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤.**
{% endhint %}

![image](../../../.gitbook/assets/subway_map_igw.png)

* [x] Internet Gateway attatched VPC

#### Route Tables

{% hint style="info" %}
**ìš”êµ¬ì‚¬í•­**

* [x] ì™¸ë¶€ë§ì€ ì¸í„°ë„· êµ¬ê°„ê³¼ í†µì‹  ê°€ëŠ¥

**VPC ë‚´ì—ì„œ íŠ¸ë˜í”½ì˜ ìœ ì…, ìœ ì¶œ, ì´ë™ì„ ì œì–´í•˜ë ¤ë©´ ë¼ìš°íŠ¸ í…Œì´ë¸”(route table)ì— ì €ì¥ëœ ë¼ìš°íŠ¸(route)ë¥¼ ì´ìš©í•´ì•¼ í•œë‹¤. ë¼ìš°íŠ¸ëŠ” ë¼ìš°íŒ… í…Œì´ë¸”ê³¼ ì—°ê²°ëœ ì„œë¸Œë„· ë‚´ì—ì„œ íŠ¸ë˜í”½ ìœ ì… ë° ìœ ì¶œì„ ê²°ì •í•©ë‹ˆë‹¤.**
{% endhint %}

> allow Any to Internet gateway

![image](../../../.gitbook/assets/subway_map_rt_igw.png)

* [x] Route table linked internet gateway to public topology

ğŸ’¡ ë§Œì•½ ë¼ìš°íŒ… í…Œì´ë¸”ì— ì¸í„°ë„·ë§ê³¼ ì—°ê²°ì´ ë˜ì§€ ì•Šì€ ìƒíƒœì—ì„œ ì„œë²„ê°€ ì¸í„°ë„·ë§ê³¼ í†µì‹  í•˜ë ¤ê³  í•œë‹¤ë©´?

ë¼ìš°íŒ… í…Œì´ë¸”ì€ VPC ì •ë³´ë§Œ ê°–ê³  ìˆê¸° ë•Œë¬¸ì— í•´ë‹¹ ìš”ì²­ì„ ë°›ë”ë¼ë„ ì¸í„°ë„·ë§ìœ¼ë¡œ ë³´ë‚´ì•¼ í•˜ëŠ”ì§€ì— ëŒ€í•œ ì •ë³´ë¥¼ ê°–ê³  ìˆì§€ ì•Šë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— í•´ë‹¹ ìš”ì²­ì€ ë°–ìœ¼ë¡œ ë‚˜ê°€ì§€ ì•Šê³  ë‚´ë¶€ì—ì„œ ë¼ìš°íŒ… í…Œì´ë¸”ì— ì˜í•´ íŒ¨í‚·ì´ ë“œë ë  ê²ƒì´ë‹¤. ì´ëŸ¬í•œ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë¼ìš°íŒ… í…Œì´ë¸”ì— ì¸í„°ë„·ë§ê³¼ ì—°ê²° í•  ìˆ˜ ìˆëŠ” ì¸í„°ë„· ê²Œì´íŠ¸ì›¨ì´ë¥¼ ì—°ê²° í•´ì£¼ëŠ” ì‘ì—…ì´ í•„ìš”í•˜ë‹¤.

> Specific subnet IPs

![image](../../../.gitbook/assets/subway_map_rt_sb.png)

* ì™¸ë¶€ë§ ì „ìš© Route
  * [x] 0.0.0.0/0: Internet Gateway ì—°ê²° (ë‚´ë¶€ <-> ì™¸ë¶€ ì–‘ë°©í–¥ í†µì‹ )
  * [x] ì„œë¸Œë„· ì—°ê²°: admin-subway-map-01, external-subway-map-subnet-01, external-subway-map-subnet-02
* ë‚´ë¶€ë§ ì „ìš© Route
  * âŒ 0.0.0.0/0: NAT Gateway (ë‚´ë¶€ -> ì™¸ë¶€ ë‹¨ë°©í–¥ í†µì‹ )
  * âŒ ì„œë¸Œë„· ì—°ê²° : internal-subway-map-subnet-01

{% hint style="info" %}
**NAT Gatewayê°€ í•„ìš”í•œ ì´ìœ **

ì™¸ë¶€ë§ì—ì„œ ë‚´ë¶€ë§ìœ¼ë¡œ ì ‘ê·¼ í•  ìˆ˜ ì—†ì§€ë§Œ, ë‚´ë¶€ ë§ì—ì„œ ì™¸ë¶€ë§ìœ¼ë¡œ ì ‘ê·¼ í•´ì•¼ í•˜ëŠ” ê²½ìš°ì— ì‚¬ìš© ë˜ë©° AWSì—ì„œ NAT Gatewayë¥¼ ì´ìš© í•˜ë©´ ì‹œê°„ë‹¹ 0.01$ ì˜ ê³¼ê¸ˆì´ ë°œìƒ&#x20;

> "ê·¸ë ‡ë‹¤ë©´ ë‚´ë¶€ë§ì—ì„œ ì™œ ì™¸ë¶€ë§ í†µì‹ ì„ í•´ì•¼ í• ê¹Œ?"
>
> 1. ë‚´ë¶€ë§ì— êµ¬ì¶• ë˜ì–´ìˆë˜ ë¬¼ë¦¬ì  ë°ì´í„°ë² ì´ìŠ¤ ì„œë²„ì˜ Docker Imageë¥¼ Hubì—ì„œ Pulling í•˜ë ¤ê³  í•œë‹¤
> 2. OS system updateë¥¼ ì§„í–‰ í•˜ë ¤ê³  í•œë‹¤.

ë“± ë‹¤ì–‘í•œ ì´ìœ ê°€ ì¡´ì¬ í•˜ì§€ë§Œ ëŒ€í‘œì ìœ¼ë¡œ ì™¸ë¶€ì—ì„œ ì ‘ê·¼ì´ ê°€ëŠ¥í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ë‚´ë¶€ë§ì—ì„œ ì ‘ê·¼í•´ì„œ ì‚¬ìš© í•´ì•¼ í•˜ëŠ” ê²½ìš° NAT Gateway êµ¬ì„±ì´ í•„ìš”í•˜ë‹¤.
{% endhint %}



#### Security Groups

**External SG**

* [x] ì „ì²´ ëŒ€ì—­ Https ì ‘ê·¼ í—ˆìš©
* [x] ê´€ë¦¬ë§ SSH ì ‘ê·¼ í—ˆìš©

> Inbound

![image](../../../.gitbook/assets/external_sg_inbound.png)

> Outbound

![image](../../../.gitbook/assets/external_sg_outbound.png)

**Internal SG**

* [x] ì™¸ë¶€ë§ MySQL ì ‘ê·¼ í—ˆìš©
* [x] ê´€ë¦¬ë§ SSH ì ‘ê·¼ í—ˆìš©

> Inbound

![image](../../../.gitbook/assets/internal_sg_inbound.png)

> Outbound

![image](../../../.gitbook/assets/internal_sg_outbound.png)

**Admin SG**

* [x] ê´€ë¦¬ì ë¡œì»¬ PCë§Œ SSH ì ‘ê·¼ ê°€ëŠ¥ í•˜ë„ë¡ í—ˆìš©

> Inbound

![image](../../../.gitbook/assets/admin_sg_inbound.png)

> Outbound

![image](../../../.gitbook/assets/admin_sg_outbound.png)



####













### ì„œë²„ êµ¬ì„±í•˜ê¸°

### ì•„í‚¤í…ì²˜ êµ¬ì„±í•˜ê¸°
